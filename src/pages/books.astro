---
import Layout from "@/layouts/Layout.astro";
import Header from "@/components/Header.astro";
import Footer from "@/components/Footer.astro";
import Main from "@/layouts/Main.astro";

const books = [
  {
    title: "Operating Systems: Three Easy Pieces",
    author: "Remzi H. Arpaci-Dusseau and Andrea C. Arpaci-Dusseau",
    cover: "https://covers.openlibrary.org/b/olid/OL29583638M-L.jpg",
    progress: Math.floor(Math.random() * 99) + 1,
    opinion: "An incredibly clear and comprehensive introduction to operating systems. A must-read for anyone diving into OS development.",
  },
  {
    title: "The Linux Programming Interface",
    author: "Michael Kerrisk",
    cover: "https://covers.openlibrary.org/b/id/8278300-L.jpg", // Generic placeholder
    progress: Math.floor(Math.random() * 99) + 1,
    opinion: "The definitive guide to Linux system programming. Every detail you could ever need, explained with precision.",
  },
  {
    title: "Computer Systems: A Programmer's Perspective",
    author: "Randal E. Bryant and David R. O'Hallaron",
    cover: "https://covers.openlibrary.org/b/olid/OL26835960M-L.jpg",
    progress: Math.floor(Math.random() * 99) + 1,
    opinion: "A fantastic book that bridges the gap between high-level programming and low-level system understanding. Essential for any serious programmer.",
  },
  {
    title: "Designing Data-Intensive Applications",
    author: "Martin Kleppmann",
    cover: "https://covers.openlibrary.org/b/id/8278300-L.jpg", // Generic placeholder
    progress: Math.floor(Math.random() * 99) + 1,
    opinion: "An absolute masterpiece for understanding distributed systems and data storage. Highly recommended for architects and senior engineers.",
  },
  {
    title: "Clean Code: A Handbook of Agile Software Craftsmanship",
    author: "Robert C. Martin",
    cover: "https://covers.openlibrary.org/b/olid/OL16900934M-L.jpg",
    progress: Math.floor(Math.random() * 99) + 1,
    opinion: "A foundational text for writing maintainable and readable code. Some ideas are debated, but the core principles are invaluable.",
  },
  {
    title: "The Mythical Man-Month",
    author: "Frederick Brooks Jr.",
    cover: "https://covers.openlibrary.org/b/olid/OL20224833M-L.jpg",
    progress: Math.floor(Math.random() * 99) + 1,
    opinion: "A classic in software engineering management. Its insights on project management and team dynamics are still relevant decades later.",
  },
  {
    title: "Structure and Interpretation of Computer Programs",
    author: "Harold Abelson and Gerald Jay Sussman",
    cover: "https://covers.openlibrary.org/b/id/8278300-L.jpg", // Generic placeholder
    progress: Math.floor(Math.random() * 99) + 1,
    opinion: "A mind-bending journey into the fundamentals of computation. It will change how you think about programming.",
  },
  {
    title: "Code Complete",
    author: "Steve McConnell",
    cover: "https://covers.openlibrary.org/b/id/240727-L.jpg",
    progress: Math.floor(Math.random() * 99) + 1,
    opinion: "A massive, practical guide to software construction. A great reference for best practices in coding.",
  },
  {
    title: "Refactoring: Improving the Design of Existing Code",
    author: "Martin Fowler",
    cover: "https://covers.openlibrary.org/b/id/8278300-L.jpg", // Generic placeholder
    progress: Math.floor(Math.random() * 99) + 1,
    opinion: "The essential handbook for improving existing codebases. Teaches you how to make changes safely and effectively.",
  },
  {
    title: "Site Reliability Engineering",
    author: "Niall Richard Murphy et al.",
    cover: "https://covers.openlibrary.org/b/id/9196728-L.jpg",
    progress: 100, // One book at 100%
    opinion: "A deep dive into how Google runs its production systems. Invaluable for anyone interested in building and operating large-scale services.",
  },
];
---

<Layout title="Books | DeeCee's Blog">
  <Header />
  <Main pageTitle="My Bookshelf" pageDesc="A collection of books I'm reading or have read, with progress.">
    <div class="space-y-6">
      {books.map(book => (
        <div class="flex items-start gap-4 py-4 border-b border-dashed border-border last:border-b-0">
          <img src={book.cover} alt={`Cover of ${book.title}`} class="w-24 h-auto object-cover flex-shrink-0 rounded-sm shadow-md" />
          <div class="flex-grow">
            <h2 class="text-xl font-semibold text-foreground">{book.title}</h2>
            <p class="text-sm text-foreground/70 mb-2">{book.author}</p>
            <div class="flex gap-1 w-full mb-1">
              {Array.from({ length: 10 }, (_, i) => {
                const segmentThreshold = (i + 1) * 10;
                const isFilled = book.progress >= segmentThreshold;
                const isPartial = !isFilled && book.progress > i * 10 && book.progress < segmentThreshold;

                return (
                  <div
                    class={`flex-1 h-3 rounded-sm transition-all duration-300 ${
                      isFilled
                        ? 'bg-accent shadow-sm'
                        : isPartial
                          ? 'bg-accent/50'
                          : 'bg-muted border border-border'
                    }`}
                  />
                );
              })}
            </div>
            <p class="text-xs text-foreground/70 mt-1">{book.progress}% Read</p>
            <p class="text-xs text-foreground/60 italic mt-2 leading-relaxed">"{book.opinion}"</p>
          </div>
        </div>
      ))}
    </div>
  </Main>
  <Footer />
</Layout>