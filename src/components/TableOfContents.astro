---
export interface Props {
  headings: { depth: number; slug: string; text: string }[];
}

const { headings } = Astro.props;

// Only show if 3+ headings
if (headings.length < 3) {
  return null;
}
---

<details class="toc-container mb-8 rounded-lg border border-border bg-muted/30 p-4">
  <summary class="cursor-pointer font-semibold text-accent hover:text-accent/80 transition-colors">
    ðŸ“‹ Table of Contents
  </summary>
  <nav class="mt-3">
    <ul class="space-y-2">
      {headings.map(heading => (
        <li
          class:list={[
            "text-sm",
            { "ml-4": heading.depth === 3 },
            { "ml-8": heading.depth === 4 },
            { "ml-12": heading.depth === 5 },
            { "ml-16": heading.depth === 6 },
          ]}
        >
          <a
            href={`#${heading.slug}`}
            class="text-foreground hover:text-accent transition-colors underline decoration-dashed underline-offset-4"
          >
            {heading.text}
          </a>
        </li>
      ))}
    </ul>
  </nav>
</details>

<style>
  .toc-container summary {
    list-style: none;
  }

  .toc-container summary::-webkit-details-marker {
    display: none;
  }

  .toc-container[open] summary::after {
    content: " â–¼";
    font-size: 0.75rem;
  }

  .toc-container:not([open]) summary::after {
    content: " â–¶";
    font-size: 0.75rem;
  }
</style>
